---
import ProjectCard from './ProjectCard.astro'

import { getCollection } from 'astro:content'
const projectCollection = await getCollection('projects')
const posts = Array.from(projectCollection)
  .map(post => {
    let data = { ...post.data, slug: post.slug }
    return data
  })
  .sort(
    (a, b) =>
      new Date(a!.content).valueOf() -
      new Date(b!.content).valueOf()
  )
  // At some point rethink this
  .slice(0, 9)
---

{
  posts.map(async post => {
    const dynamicImage = await import(`../assets/projects/${post!.heroImage}.png`)
    return (
      <ProjectCard
        techs={post!.techs}
        url={post!.repository}
        image={dynamicImage.default}
        name={post!.title}
        desc={post!.description}
        live={post!.live}
        md={post!.md}
        hackathon={post!.hackathon}
      />
    )
  })
}
